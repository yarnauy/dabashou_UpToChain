# spring-boot-starter

本示例项目基于Java SDK + Gradle + SpringBoot方式来调用智能合约。

### 测试链信息

- 节点数：4
- rpc addr:
  - 18.163.74.253:20200
  - 18.163.74.253:20201
  - 18.163.74.253:20202
  - 18.163.74.253:20203


### 客户端信息

#### 软件依赖

- Java: JDK 1.8 - JDK 14均可
- 区块链交互工具: fisco-bcos-java-sdk:3.3.0
- 构建工具这里采用了gradle,版本为6.3，以供参考


#### java应用构建引导(以gradle项目为例)
##### 需要关注的配置部分
1. 依赖库,以 参考[这里](./build.gradle),（7.0以上版本gradle不兼容)
2. 配置文件[application.properties](./src/main/resources/application.properties)

其中：

-  请将network.peers更换成实际的链节点监听地址。
-  会有一些证书和秘钥文件需要存放，cryptoMaterial.certPath设为存放路径，默认是conf，即./src/main/resource/conf
- contract.wasteManagerAddress 和contract.algoRegistryAddress 是链上代码的地址，区块链团队提供，当链上逻辑更新时，需要更新
- Springboot configuration不用关心

3. 配置证书
   将证书拷贝到src/main/resources/conf目录下，（该项目已经拷贝完成，可以参考）。
4. 配置abi和bin，直接把bin和abi两个目录拷贝到resource下面即可

## 编译和运行

您可以在idea内直接运行，也可以编译成可执行jar包后运行。以编译jar包方式为例：

```shell
cd spring-boot-starter
bash gradlew bootJar
cd dist
```

会在dist目录生成可执行jar包：

```shell
java -jar demo-exec.jar
```

随后，即可访问相关接口。

set示例：

```shell
curl http://127.0.0.1:8080/wastemanager/dispose
```

返回示例（表示交易哈希）：

<code>
TransactionReceipt{transactionHash='0xebc8274fd9a10289afb050b8007c990c938bdb9b5cfa95387447293e2a311cd9', version='0', blockNumber='83', from='0xf8b623ea8f77e429da4b68eb63d93001b9e8b734', to='0xe7d7b002e51431b300ddc00b2c059ccc41ce4660', gasUsed='53990', contractAddress=', checksumContractAddress='', logs=[], status='0', extraData='', input='0x16da8da10000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000006642fe1500000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000001e00000000000000000000000000000000000000000000000000000000000000220000000000000000000000000000000000000000000000000000000000000026000000000000000000000000000000000000000000000000000000000000002a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002e0000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000004ce0000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000006400000000000000000000000000000000000000000000000000000000000000086f726465723132330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007757365723131330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000096465766963653134330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000662696e31323300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008636f757274313133000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000331323300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009e5b9b2e59e83e59cbe0000000000000000000000000000000000000000000000', output='0x0000000000000000000000000000000000000000000000000000000000000000', txProof=null, txReceiptProof=null}
</code>

其中transactionHash可以作为这次事件的证据存在业务系统， status作为事件上链状态判断，0代表成功。
